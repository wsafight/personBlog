# 漫谈数据传输格式

自从道格拉斯发明 JSON 后，JSON 就成为了事实上的最广泛应用的通信格式。

随着互联网应用的发展，我们的服务从早期流行的单体架构模式，逐步演进成了微服务架构的模式，而微服务之间通信，最常见的方式就是基于 RPC 的通信方式。它能让我们可以像调用本地方法一样，调用远程服务器上的方法。具体来说，我们会将过程调用里的参数对象转化成网络中可传输的二进制流，从客户端发送给服务端，然后在服务端按照同样的协议规范，从二进制流中反序列化并组装出调用方法中的入参对象，进行本地方法调用。

而 RPC 方式中最常用的就是 Protobuf。

那 RPC 为什么不采用 JSON 呢？

主要原因就是，JSON 序列化采用了文本而非二进制的传输方式，并且在序列化过程中引入了冗长的成员变量名等数据，空间利用率就很差。加上使用方还需要对 JSON 文本进行解析和转化，会耗费 CPU 资源，因此，即使 JSON 本身非常流行，也并没有成为主流的 RPC 序列化协议。而 Protobuf 的协议，采用二进制编码，并引入了 schema 文件，去掉了许多冗余的成员变量信息，直接采用字段编号进行成员标识，同时也具备一定的安全性（没有对应的 schema 就无法解码）。


https://github.com/capnproto/capnproto